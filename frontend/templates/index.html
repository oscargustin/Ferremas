<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FERREMAS - Buscador y Venta</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>FERREMAS - Buscador y Venta (Administración)</h1>
        </header>

        <main id="app-content">
            <section id="sale-view" class="main-content-grid view active">
                <div class="search-section">
                    <h2>Buscador de Productos</h2>
                    <label for="product-search">Buscar Producto (ID o Nombre):</label>
                    <input type="text" id="product-search" placeholder="Ingresa ID o nombre del producto">
                    <button id="search-button">Buscar</button>
                    <!-- NUEVO: Botón para abrir el modal de añadir producto -->
                    <button id="add-product-button">Añadir Nuevo Producto</button>
                    
                    <h3>Resultados de Búsqueda</h3>
                    <ul id="product-results-list">
                    </ul>
                    <p id="search-message" class="message"></p>
                </div>

                <div class="sale-details-section">
                    <h2>Detalle de Venta</h2>
                    <p>Producto Seleccionado: <span id="selected-product-name">Ninguno</span></p>
                    <p>Sucursal Seleccionada: <span id="selected-branch-name">Ninguna</span></p>
                    <p>Stock Disponible: <span id="selected-product-stock">N/A</span></p>

                    <div class="form-group">
                        <label for="quantity">Cantidad:</label>
                        <input type="number" id="quantity" value="1" min="1">
                        <button id="calculate-button">Calc USD</button>
                    </div>

                    <p>Precio Unitario (CLP): <span id="unit-price-clp">0</span></p>
                    <p>Total (CLP): <span id="total-clp">0</span></p>
                    <p>Total (USD): <span id="total-usd">0</span></p>
                    <button id="sell-button" disabled>Realizar Venta</button>
                </div>

                <div class="messages-section">
                    <p id="status-message" class="message"></p>
                </div>

                <div class="notifications-section">
                    <h3>Alertas de Stock Bajo</h3>
                    <div id="low-stock-notifications"></div>
                </div>

            </section>
        </main>

        <footer>
            <p>&copy; 2025 FERREMAS</p>
        </footer>
    </div>

    <!-- Modal de confirmación existente -->
    <div id="myModal" class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h3 id="modal-title"></h3>
        <p id="modal-body"></p>
        <button id="modal-ok-button">OK</button>
      </div>
    </div>

    <!-- NUEVO: Modal para el formulario de añadir/editar producto -->
    <div id="productFormModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-product-form-modal">&times;</span>
            <h3 id="product-form-title">Añadir Nuevo Producto</h3>
            <form id="product-form">
                <div class="form-group">
                    <label for="product-name">Nombre del Producto:</label>
                    <input type="text" id="product-name" required>
                </div>
                <div class="form-group">
                    <label for="product-description">Descripción:</label>
                    <textarea id="product-description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="product-price">Precio Base (CLP):</label>
                    <input type="number" id="product-price" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="product-image">Imagen del Producto:</label>
                    <input type="file" id="product-image" accept="image/*">
                    <img id="image-preview" src="#" alt="Vista previa de la imagen" style="display:none;">
                </div>
                <button type="submit" id="save-product-button">Guardar Producto</button>
                <button type="button" id="cancel-product-button">Cancelar</button>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
